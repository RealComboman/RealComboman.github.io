<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>1Keys ðŸŽ¹ Tiny JS Piano</title>
<meta charset="utf-8">
</head><body id="B" style="background:#112;color:#fff;user-select:none;text-align:center">
<span id="K" style="font-size:20">âˆ¿<input type="radio" name="I" checked="checked" onclick="I=3"> &nbsp;ðŸŽ»<input type="radio" name="I" onclick="I=2"> &nbsp;ðŸŽ·<input type="radio" name="I" onclick="I=1"> &nbsp;ðŸŽ¹<input type="radio" name="I" onclick="I=0"> &nbsp;</span>
Octave <input type="number" id="O" style="width:40" value="0" min="-3" max="3" onkeydown="return false">&nbsp;
Key <input type="number" id="Y" style="width:40" value="0" min="-12" max="12" onkeydown="return false">&nbsp;
Shape <select id="S">
<option>sine</option>
<option selected="selected">square</option>
<option>sawtooth</option>
<option>triangle</option>
</select>
<br><script>

///////////////////////////////////////////////////////////////////////////////
/* 1Keys ðŸŽ¹ A 1 Kilobyte JavaScript Piano - Enhanced Version

By Frank Force 2020
https://github.com/KilledByAPixel/1Keys

Globals...
    K# = piano keys
    K = instruments div
    O = octave input
    Y = key input
    S = wave shape
*/

C = new AudioContext; // audio context
A = [];               // active sounds
I = 0;                // instrument type

// instrument select
[...`âˆ¿ðŸŽ»ðŸŽ·ðŸŽ¹`].map((i,j)=>                          // instrument icons
    K.innerHTML += `${i                            // icon
    }<input type=radio name=I checked onclick=I=${ // radio input
    3 - j}> &nbsp;`);                              // instrument select

// piano keys
for( i = 0; i < 36; i++) // 3 x 12 keys
        
    B.innerHTML +=
        `${i%12 ? `` : `<br>`                                       // new row
        }<div id=K${                                                // create key
            k = 24 + i%12 - (i/12|0)*12                             // reorder keys
        } style=display:inline-block;margin:2;background:${         // key style
        (w = `02579`.indexOf(i%12 - 1) < 0) ?                       // b or w?
        `#fff;color:#000;width:60;height:180` :                     // white
        `#000;position:absolute;margin-left:-17;width:33;height:99` // black
        } onmouseover=event.buttons&&P(${ k                         // mouse over
        }) onmousedown=P(${ k                                       // mouse down
        }) onmouseup=X(${ k                                         // mouse up
        }) onmouseout=X(${ k                                        // mouse out
        })>` + (w ? `<br>` : ``) +                                  // lower white keys
        `ZSXDCVGBHNJMQ2W3ER5T6Y7UI9O0P[=]Â Â Â Â `[k];                  // show key

///////////////////////////////////////////////////////////////////////////////
// sound

// play note
P = i=> i < 0 || A[i] || // is valid and note not playing?
(
    k = eval(`K`+i),            // get key
    k.g = k.style.background,   // save original color 
    k.style.transition = ``,    // unset transition
    k.style.background = `red`, // set key color red
    k.innerHTML,                // force reset transition

    A[i] = [         // instruments
        [...`1248`], // ðŸŽ¹ organ
        [...`3579`], // ðŸŽ· brass
        [...`123`],  // ðŸŽ» strings
        [...`4`],    // âˆ¿ sine
    ][ I ].map(j=>(
        o = C.createOscillator(),                 // create oscillator
        o.connect(                                // oscillator to gain
            o.g = C.createGain(                   // create gain node
                o.frequency.value =               // set frequency
                    j * 55 *                      // A 55 root note
                    2**((i+3)/12                  // music scale formula
                        + O.value*1               // octave control
                        + Y.value/12)))           // key control
        .connect(C.destination),                  // gain to destination
        o.g.gain.value = .2/(1+Math.log2(j)),     // set gain
        o.type =                                  // oscilator type
            S.options[S.selectedIndex].innerHTML, // get type setting
        o.start(),                                // play sound
        o)                                        // return sound
    )
);

// cancel note
X = i=> A[i] &&  // is note playing?
(
    k = eval(`K`+i),            // get key
    k.style.transition = `.5s`, // set transition
    k.style.background = k.g,   // reset original color

    A[i].map(o=>
        setTimeout(e=>o.stop(), 350,            // stop sound after delay
            o.g.gain.linearRampToValueAtTime(   // set gain start ramp
                o.g.gain.value, C.currentTime), // set gain
            o.g.gain.linearRampToValueAtTime(   // ramp off gain
                A[i] = 0, C.currentTime + .3)   // clear note  
        )
    )
);

// stop all sounds if focus lost
onblur = e=> A.map((e,i)=> X(i));

///////////////////////////////////////////////////////////////////////////////
// keyboard controls

// keyboard key to piano key
T = i=>
    (k = `ZSXDCVGBHNJM,L.;/Q2W3ER5T6Y7UI9O0P[=]` // map key to note
    .indexOf(i.key.toUpperCase()),               // find key in string
    k - 5 * (k > 16));                           // remap second row of keys

// play note on key down
onkeydown = i=> P(T(i));

// release note on key up
onkeyup = i=> X(T(i));

</script><br><div id="K24" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(24)" onmousedown="P(24)" onmouseup="X(24)" onmouseout="X(24)"><br>I</div><div id="K25" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(25)" onmousedown="P(25)" onmouseup="X(25)" onmouseout="X(25)">9</div><div id="K26" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(26)" onmousedown="P(26)" onmouseup="X(26)" onmouseout="X(26)"><br>O</div><div id="K27" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(27)" onmousedown="P(27)" onmouseup="X(27)" onmouseout="X(27)">0</div><div id="K28" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(28)" onmousedown="P(28)" onmouseup="X(28)" onmouseout="X(28)"><br>P</div><div id="K29" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(29)" onmousedown="P(29)" onmouseup="X(29)" onmouseout="X(29)"><br>[</div><div id="K30" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(30)" onmousedown="P(30)" onmouseup="X(30)" onmouseout="X(30)">=</div><div id="K31" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(31)" onmousedown="P(31)" onmouseup="X(31)" onmouseout="X(31)"><br>]</div><div id="K32" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(32)" onmousedown="P(32)" onmouseup="X(32)" onmouseout="X(32)">&nbsp;</div><div id="K33" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(33)" onmousedown="P(33)" onmouseup="X(33)" onmouseout="X(33)"><br>&nbsp;</div><div id="K34" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(34)" onmousedown="P(34)" onmouseup="X(34)" onmouseout="X(34)">&nbsp;</div><div id="K35" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(35)" onmousedown="P(35)" onmouseup="X(35)" onmouseout="X(35)"><br>&nbsp;</div><br><div id="K12" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(12)" onmousedown="P(12)" onmouseup="X(12)" onmouseout="X(12)"><br>Q</div><div id="K13" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(13)" onmousedown="P(13)" onmouseup="X(13)" onmouseout="X(13)">2</div><div id="K14" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(14)" onmousedown="P(14)" onmouseup="X(14)" onmouseout="X(14)"><br>W</div><div id="K15" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(15)" onmousedown="P(15)" onmouseup="X(15)" onmouseout="X(15)">3</div><div id="K16" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(16)" onmousedown="P(16)" onmouseup="X(16)" onmouseout="X(16)"><br>E</div><div id="K17" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(17)" onmousedown="P(17)" onmouseup="X(17)" onmouseout="X(17)"><br>R</div><div id="K18" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(18)" onmousedown="P(18)" onmouseup="X(18)" onmouseout="X(18)">5</div><div id="K19" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(19)" onmousedown="P(19)" onmouseup="X(19)" onmouseout="X(19)"><br>T</div><div id="K20" style="display: inline-block; margin: 2px 2px 2px -17px; background: rgb(0, 0, 0); position: absolute; width: 33px; height: 99px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(20)" onmousedown="P(20)" onmouseup="X(20)" onmouseout="X(20)">6</div><div id="K21" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(21)" onmousedown="P(21)" onmouseup="X(21)" onmouseout="X(21)"><br>Y</div><div id="K22" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(22)" onmousedown="P(22)" onmouseup="X(22)" onmouseout="X(22)">7</div><div id="K23" style="display: inline-block; margin: 2px; background: rgb(255, 255, 255); color: rgb(0, 0, 0); width: 60px; height: 180px; transition: 0.5s;" onmouseover="event.buttons&amp;&amp;P(23)" onmousedown="P(23)" onmouseup="X(23)" onmouseout="X(23)"><br>U</div><br><div id="K0" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(0)" onmousedown="P(0)" onmouseup="X(0)" onmouseout="X(0)"><br>Z</div><div id="K1" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(1)" onmousedown="P(1)" onmouseup="X(1)" onmouseout="X(1)">S</div><div id="K2" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(2)" onmousedown="P(2)" onmouseup="X(2)" onmouseout="X(2)"><br>X</div><div id="K3" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(3)" onmousedown="P(3)" onmouseup="X(3)" onmouseout="X(3)">D</div><div id="K4" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(4)" onmousedown="P(4)" onmouseup="X(4)" onmouseout="X(4)"><br>C</div><div id="K5" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(5)" onmousedown="P(5)" onmouseup="X(5)" onmouseout="X(5)"><br>V</div><div id="K6" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(6)" onmousedown="P(6)" onmouseup="X(6)" onmouseout="X(6)">G</div><div id="K7" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(7)" onmousedown="P(7)" onmouseup="X(7)" onmouseout="X(7)"><br>B</div><div id="K8" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(8)" onmousedown="P(8)" onmouseup="X(8)" onmouseout="X(8)">H</div><div id="K9" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(9)" onmousedown="P(9)" onmouseup="X(9)" onmouseout="X(9)"><br>N</div><div id="K10" style="display:inline-block;margin:2;background:#000;position:absolute;margin-left:-17;width:33;height:99" onmouseover="event.buttons&amp;&amp;P(10)" onmousedown="P(10)" onmouseup="X(10)" onmouseout="X(10)">J</div><div id="K11" style="display:inline-block;margin:2;background:#fff;color:#000;width:60;height:180" onmouseover="event.buttons&amp;&amp;P(11)" onmousedown="P(11)" onmouseup="X(11)" onmouseout="X(11)"><br>M</div><protonpass-root-c149 data-protonpass-role="root" data-protonpass-theme="light"></protonpass-root-c149></body></html>